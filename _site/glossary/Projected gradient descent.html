<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Projected gradient descent</title>
	<link rel="stylesheet" href="/assets/css/styles.css" />
</head>
<body>
<h1>Projected gradient descent</h1>

<p>Projected gradient descent is a simple modification of gradient
descent. Instead of setting the next iterate to</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msup><mi>x</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>=</mo><msup><mi>x</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>−</mo><mi>η</mi><mi>∇</mi><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>x</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
x^{(t+1)} = x^{(t)} - \eta \nabla f(x^{(t)}),
\end{align*}</annotation></semantics></math> we set the next iterate to
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msup><mi>x</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>=</mo><msub><mi>P</mi><mi>𝒮</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>x</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>−</mo><mi>η</mi><mi>∇</mi><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>x</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
x^{(t+1)} = P_{\mathcal{S}} (x^{(t)} - \eta \nabla f(x^{(t)})).
\end{align*}</annotation></semantics></math></p>
<h2 id="projected-gradient-descent-convergence-bound">Projected gradient
descent convergence bound</h2>
<p>(PGD convergence bound)</p>
<p>If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo>,</mo><mi>𝒮</mi></mrow><annotation encoding="application/x-tex">f, \mathcal{S}</annotation></semantics></math>
are <a href="Convex%20function.html">convex</a> and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo>≥</mo><mfrac><mrow><msup><mi>R</mi><mn>2</mn></msup><msup><mi>G</mi><mn>2</mn></msup></mrow><msup><mi>ϵ</mi><mn>2</mn></msup></mfrac></mrow><annotation encoding="application/x-tex">T \geq \frac{R^2 G^2}{\epsilon^2}</annotation></semantics></math>,
then
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>𝐱</mi><mo accent="true">̂</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo>≤</mo><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>𝐱</mi><mo mathvariant="bold">*</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">f(\mathbf{\hat x}) \leq f(\mathbf{x^*}) + \epsilon</annotation></semantics></math>.</p>
<h2 id="analysis">Analysis</h2>
<p><a href="Projected%20gradient%20descent%20convergence%20bound.html">PGD
convergence bound</a></p>
<hr />
<p>Compare PGD to <a href="Gradient%20descent.html">GD</a></p>
<p>In GD:</p>
<ol type="1">
<li>Pick an initial point
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝐱</mi><mn>0</mn></msub><mo>∈</mo><msup><mi>ℝ</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{x}_0 \in \mathbb{R}^n</annotation></semantics></math></li>
<li>Loop until stopping condition is met:
<ol type="1">
<li>descent direction: compute
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mi>∇</mi><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐱</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">-\nabla f(\mathbf{x}_k)</annotation></semantics></math></li>
<li>stepsize: pick a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>α</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\alpha_k</annotation></semantics></math></li>
<li>update:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝐱</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>𝐱</mi><mi>k</mi></msub><mo>−</mo><mi>α</mi><mi>∇</mi><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐱</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{x}_{k+1} = \mathbf{x}_{k}-\alpha \nabla f(\mathbf{x}_k)</annotation></semantics></math></li>
</ol></li>
</ol>
<p>In PGD:</p>
<ol type="1">
<li>Pick an initial point
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝐱</mi><mn>0</mn></msub><mo>∈</mo><mi>𝒬</mi></mrow><annotation encoding="application/x-tex">\mathbf{x}_0 \in \mathcal{Q}</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝒬</mi><annotation encoding="application/x-tex">\mathcal{Q}</annotation></semantics></math>
is a set to constrain the solution</li>
<li>Loop until stopping condition is met:
<ol type="1">
<li>descent direction: compute
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mi>∇</mi><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐱</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">-\nabla f(\mathbf{x}_k)</annotation></semantics></math></li>
<li>stepsize: pick a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>α</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\alpha_k</annotation></semantics></math></li>
<li>update:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝐲</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>𝐱</mi><mi>k</mi></msub><mo>−</mo><mi>α</mi><mi>∇</mi><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐱</mi><mi>k</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{y}_{k+1} = \mathbf{x}_{k}-\alpha \nabla f(\mathbf{x}_k)</annotation></semantics></math></li>
<li>projection:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝐱</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mrow><mo>arg</mo><mo>min</mo></mrow><mrow><mi>𝐱</mi><mo>∈</mo><mi>𝒬</mi></mrow></msub><mfrac><mn>1</mn><mn>2</mn></mfrac><mrow><mo stretchy="true" form="prefix">|</mo><mo stretchy="true" form="postfix">|</mo></mrow><mi>𝐱</mi><mo>−</mo><msub><mi>𝐲</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><msubsup><mrow><mo stretchy="true" form="prefix">|</mo><mo stretchy="true" form="postfix">|</mo></mrow><mn>2</mn><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\mathbf{x}_{k+1} = {\arg\min}_{\mathbf{x} \in \mathcal{Q}} \frac{1}{2}||\mathbf{x}-\mathbf{y}_{k+1}||_2^2</annotation></semantics></math></li>
</ol></li>
</ol>
<hr />
<p>References:</p>
<ol type="1">
<li><a
href="https://angms.science/doc/CVX/CVX_PGD.pdf">https://angms.science/doc/CVX/CVX_PGD.pdf</a></li>
<li><a
href="https://www.chrismusco.com/amlds2023/notes/lecture06.html#Projected_Gradient_Descent">https://www.chrismusco.com/amlds2023/notes/lecture06.html#Projected_Gradient_Descent</a></li>
</ol>
</body>
</html>
